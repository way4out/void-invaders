<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Void Invaders</title>
<style>
  body{margin:0;background:#000;color:#0f0;font-family:courier new;overflow:hidden}
  canvas{display:block;width:100vw;height:100vh;background:#001}
  #connect{position:absolute;top:20px;left:50%;transform:translateX(-50%);z-index:99;padding:15px 30px;font-size:18px;background:#000;border:2px solid #0f0;color:#0f0}
  #status{position:absolute;top:70px;left:50%;transform:translateX(-50%);z-index:99}
</style>
</head>
<body>

<button id="connect">CONNECT WALLET â€“ WORKS EVERYWHERE</button>
<div id="status">Wallet: not connected</div>
<canvas id="c"></canvas>

<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
<script>
  const status = document.getElementById('status');
  const btn = document.getElementById('connect');

  async function connect() {
    let provider;
    if (window.ethereum) {
      provider = window.ethereum;
      try { await provider.request({ method: 'eth_requestAccounts' }); }
      catch { status.textContent = 'User rejected'; return; }
    } else {
      provider = new WalletConnectProvider({ rpc: { 8453: "https://mainnet.base.org" } });
      await provider.enable();
    }

    const web3 = new Web3(provider);
    const accounts = await web3.eth.getAccounts();
    const acc = accounts[0];

    // force Base
    try {
      await provider.request({ method: 'wallet_switchEthereumChain', params: [{ chainId: '0x2105' }] });
    } catch (e) {
      await provider.request({ method: 'wallet_addEthereumChain', params: [{
        chainId: '0x2105', chainName: 'Base', rpcUrls: ['https://mainnet.base.org'],
        nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
        blockExplorerUrls: ['https://basescan.org']
      }]});
    }

    status.textContent = `Connected: ${acc.slice(0,6)}...${acc.slice(-4)}`;
    btn.textContent = "WALLET CONNECTED";
    btn.disabled = true;
  }

  btn.onclick = connect;

  // tiny demo so you see canvas works
  const c = document.getElementById('c');
  const ctx = c.getContext('2d');
  function resize(){c.width=innerWidth;c.height=innerHeight;}
  resize(); window.onresize=resize;
  let x = c.width/2;
  c.ontouchmove = e => x = e.touches[0].clientX;
  function loop(){
    ctx.fillStyle='#000'; ctx.fillRect(0,0,c.width,c.height);
    ctx.fillStyle='#0f0'; ctx.fillRect(x-30,c.height-80,60,60);
    requestAnimationFrame(loop);
  }
  loop();
</script>
</body>
</html>
