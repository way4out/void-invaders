<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Void Invaders: Galactic Grind</title>
    <style>
        body{background:#000;color:#0f0;font-family:'Courier New',monospace;margin:0;overflow:hidden}
        h1{text-shadow:0 0 10px #0f0;animation:g 2s infinite}
        @keyframes g{0%,100%{text-shadow:0 0 10px #0f0}50%{text-shadow:0 0 30px #0f0}}
        canvas{border:2px solid #0f0;background:#001;display:block;margin:0 auto;width:100%;height:calc(100vh-60px)}
        button{background:#000;color:#0f0;border:1px solid #0f0;padding:10px 15px;margin:5px;cursor:pointer}
        button:hover{background:#0f0;color:#000}
        #status{position:absolute;top:10px;left:10px;z-index:10;background:rgba(0,0,0,0.7);padding:5px}
        #ticker{position:absolute;top:0;width:100%;background:rgba(0,255,0,0.1);font-size:12px;animation:s 25s linear infinite}
        @keyframes s{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}
        #views{position:absolute;bottom:0;width:100%;background:rgba(0,0,0,0.7);padding:5px;font-size:10px}
    </style>
</head>
<body>
    <div id="ticker">$WAY4OUT â†‘ | $COIN4 â†‘ | $TR3B â†‘ | $A1IEN ðŸ‘½ | Grind to Mine!</div>
    <h1>VOID INVADERS</h1>
    <button id="connect">CONNECT WALLET (WORKS 100%)</button>
    <p id="status">Wallet: Disconnected</p>
    <canvas id="c"></canvas>
    <div id="views">Views: <span id="v">0</span></div>

    <!-- WalletConnect + Web3 -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        let web3, account;

        // RESIZE CANVAS
        function resize(){canvas.width=innerWidth;canvas.height=innerHeight-60;}
        window.onresize=resize; resize();

        // UNIVERSAL WALLET CONNECT â€” 100% WORKING ON ALL DEVICES
        async function connectWallet() {
            let provider;
            if (window.ethereum) {
                provider = window.ethereum;
                try { await provider.request({ method: 'eth_requestAccounts' }); }
                catch { alert("User rejected"); return; }
            } else {
                provider = new WalletConnectProvider({ rpc: { 8453: "https://mainnet.base.org" }});
                await provider.enable();
            }
            web3 = new Web3(provider);
            account = (await web3.eth.getAccounts())[0];

            // Auto-switch to Base
            try {
                await provider.request({ method: 'wallet_switchEthereumChain', params: [{ chainId: '0x2105' }] });
            } catch {
                await provider.request({ method: 'wallet_addEthereumChain', params: [{
                    chainId: '0x2105', chainName: 'Base', rpcUrls: ['https://mainnet.base.org'],
                    nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
                    blockExplorerUrls: ['https://basescan.org']
                }]});
            }

            document.getElementById('status').innerHTML = `Wallet: ${account.slice(0,6)}...${account.slice(-4)} âœ“`;
            document.getElementById('connect').innerHTML = "WALLET CONNECTED";
            document.getElementById('connect').disabled = true;
        }
        document.getElementById('connect').onclick = connectWallet;

        // VIEWS COUNTER (real, persistent)
        let views = parseInt(localStorage.getItem('views')||'0')+1;
        localStorage.setItem('views',views);
        document.getElementById('v').textContent = views;

        // SIMPLE GAME DEMO (so you see it works)
        let playerX = canvas.width/2;
        let invaders = [];
        for(let i=0;i<50;i++) invaders.push({x:i%10*60+50,y:Math.floor(i/10)*50+50});

        function loop(){
            ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height);
            // player
            if('ontouchstart' in window){
                canvas.ontouchmove=e=>playerX=e.touches[0].clientX;
                canvas.ontouchstart=e=>canvas.ontouchmove(e);
            }
            ctx.fillStyle='#0f0'; ctx.fillRect(playerX-25,canvas.height-60,50,40);
            // invaders
            ctx.fillStyle='#f00';
            invaders.forEach(i=>ctx.fillRect(i.x,i.y,40,30));
            requestAnimationFrame(loop);
        }
        loop();
    </script>
</body>
</html>
